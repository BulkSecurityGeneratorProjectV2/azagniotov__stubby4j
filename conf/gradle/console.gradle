tasks.withType(Test) {
    Task testTask ->
    testLogging {
       events /*"passed",*/ "skipped", "failed"
       exceptionFormat "full"
       showExceptions true
       showCauses true
       showStackTraces true
    }
    afterSuite { testDescriptor, testResult ->
       if (testDescriptor.getName().contains("$stubbyProjectGroup")) {
          if (project(':').ext.subprojectTestTotals[project.name.toUpperCase()] == null) {
            project(':').ext.subprojectTestTotals[project.name.toUpperCase()] = [:]
            project(':').ext.subprojectTestTotals[project.name.toUpperCase()]['total'] = 0
            project(':').ext.subprojectTestTotals[project.name.toUpperCase()]['success'] = 0
          }
          project(':').ext.subprojectTestTotals[project.name.toUpperCase()]['success'] += testResult.getSuccessfulTestCount()
          project(':').ext.subprojectTestTotals[project.name.toUpperCase()]['total'] += testResult.getTestCount()
          project(':').ext.subprojectTestTotals['total'] += testResult.getTestCount()
       }
    }
}

